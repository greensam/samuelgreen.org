<!DOCTYPE html><html itemscope itemtype="http://schema.org/Article"><head><title>Working with filesystems in Node.js | Shape Shed</title><meta property="og:title" value="Working with filesystems in Node.js | Shape Shed"><meta description="Node's fs module gives you a great cross-platform toolkit for working with filesystems. With a few third-party modules it becomes everything you need"><meta name="twitter:description" value="Node's fs module gives you a great cross-platform toolkit for working with filesystems. With a few third-party modules it becomes everything you need"><meta property="og:description" value="Node's fs module gives you a great cross-platform toolkit for working with filesystems. With a few third-party modules it becomes everything you need"><meta keywords="Node.js,JavaScript"><meta itemprop="keywords" content="Node.js,JavaScript"><meta charset="utf-8"><meta name="author" content="George Ornbo"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="twitter:card" value="summary"><meta name="twitter:title" value="Working with filesystems in Node.js | Shape Shed"><meta name="twitter:site" value="@shapeshed"><meta name="twitter:creator" value="@shapeshed"><meta name="twitter:domain" value="shapeshed.com"><meta property="og:type" value="article"><meta property="og:site_name" value="Shape Shed"><meta itemprop="isFamilyFriendly" content="true"><meta itemprop="inLanguage" content="en-GB"><link rel="stylesheet" href="/stylesheets/application-7c8a1e57cc84fce606a31bcfe30fcb98.css"><link href="/atom.xml" rel="alternate" title="Shape Shed" type="application/atom+xml"><link rel="author" href="https://plus.google.com/u/0/112147367550950112369/posts"><link rel="publisher" href="https://plus.google.com/u/0/112147367550950112369"></head><body><article><p class="date"> <time datetime="2013-03-08T08:38:51.000Z" data-updated="true" itemprop="datePublished">Friday, March 08, 2013</time></p><h1 itemprop="headline name">Working with filesystems in Node.js</h1><div itemprop="articleBody"><h2 itemprop="description" class="dropcap">Node's fs module gives you a great cross-platform toolkit for working with filesystems. With a few third-party modules it becomes everything you need</h2><h2>Different ways to read a file</h2>
<p>Node provides three different ways to read a file through the <code>fs</code> module.</p>
<ul>
<li>Synchronously</li>
<li>Asynchronously</li>
<li>As a stream</li>
</ul>
<p>To read a file synchronously you can do this</p>
<pre><code>var data = fs.readFileSync(&#39;/path/to/some/file.txt&#39;,&#39;utf8&#39;);</code></pre>
<p>To read a file asynchronously you can do this</p>
<pre><code>fs.readFile(&#39;/path/to/some/file.txt&#39;, function (err, data) {
  if (err) throw err;
  console.log(data);
});</code></pre>
<p>Finally to read a file as a stream you can do this</p>
<pre><code>var readStream = fs.createReadStream(&#39;/path/to/some/file.txt&#39;);</code></pre>
<p>The difference in these are fundamental to how node works. The synchronous read will halt your program until the read has finished. The asynchronous read lets your program get on with other things and makes the data available via the callback. Reading a file as a stream makes the data available as soon as chunks of it are ready and lets you pipe it through other streams too. </p>
<p>The <code>fs</code> module provides most things that you need. If you are a UNIX user the <a href="http://nodejs.org/api/fs.html">api</a> should be familiar to you.</p>
<h2>Just enough but missing some things</h2>
<p>The <code>fs</code> module provides a good toolkit for working with the filesystem but some operations are missing. If you do anything moderately complex with the <code>fs</code> module you will realise that you will either have to start getting into nested callback operations or look to third party modules to help you out. Thankfully there are some excellent (and small) third-party modules available.</p>
<h2>Rimraf</h2>
<p><a href="https://github.com/isaacs/rimraf">Rimraf</a> provides an <code>rm -rf</code> for node. If there are times when you want to recursively delete files this is a tool that does one thing well. </p>
<pre><code>rimraf(&#39;/some/folder&#39;, function(err) {
  if (err) { throw err; }
  // done
})</code></pre>
<h2>mkdirp</h2>
<p>If you are a UNIX user you are probably used to doing <code>mkdir -p /some/directory/path</code>. This will create all the directories in the path if they don&#39;t exist. If you are just using the <code>fs</code> module this is difficult to do but the <a href="https://github.com/substack/node-mkdirp">mkdirp</a> module comes to the rescue.</p>
<pre><code>mkdirp(&#39;/some/directory/path&#39;, function (err) {
  if (err) { throw err; }
  // done
});</code></pre>
<h2>chmodr</h2>
<p><a href="https://github.com/isaacs/chmodr">chomdr</a> does what you would expect <code>chmod -R</code> or recursively changing file or folder permissions. </p>
<pre><code>chmodr(&quot;/some/folder&quot;, 0777, function (err) {
  if (err) { throw err; }
  // done
})</code></pre>
<h2>chown</h2>
<p><a href="https://github.com/isaacs/chmodr">chown</a> recursively changes the ownership of files and folders like <code>chown -R</code> in UNIX. </p>
<pre><code>chownr(&quot;/some/folder&quot;, 501, 20, function (err) {
  if (err) { throw err; }
  // done
})</code></pre>
<h2>ncp</h2>
<p>Sooner or later you will want to do a recursive copy like <code>cp -R</code> in UNIX. This is tricky with the <code>fs</code> module but a module called <a href="https://github.com/AvianFlu/ncp">ncp</a> can help you achive that.</p>
<pre><code>ncp(&#39;/dir/to/copy/from&#39;, &#39;/dir/to/copy/to&#39;, function (err) {
  if (err) { throw err; }
  // done
});</code></pre>
<h2>Other tools</h2>
<p>There are wealth of other tools available. Check <a href="https://npmjs.org/browse/keyword/filesystem">npm</a> for <code>fs</code> module extensions and other goodies. Personally I favour modules that do one thing well but there are a number of modules that extend the <code>fs</code> module with more methods if that is your kind of thing.</p>
<h2>Conclusion</h2>
<p>Node&#39;s <code>fs</code> module gives you enough to work with filesystems and provides a single API to smooth out differences between operating systems. The third-party module ecosystem picks things up from there and plugs a few gaps to make node a very capable tool for working with filesystems. Personally I think it is great that more functionality isn&#39;t shoved into core modules. Experience of standard libraries like <a href="http://ruby-doc.org/stdlib-2.0/libdoc/net/http/rdoc/Net/HTTP.html">Net:HTTP</a> in Ruby suggest that core is where things go to rot and third-party libraries are often better anyway. </p>
</div><p>Have an update or suggestion for this article? <a href="https://github.com/shapeshed/shapeshed.com/blob/master/src/_posts/working_with_filesystems_in_nodejs.md">You can edit it here and send me a pull request.</a></p></article><footer><h2>About the author</h2><p>I'm a student at Harvard College based for the summer in New York, NY. I currently get paid to develop in Java recultantly, though I'm coming around. I speak rails and I'm about to pick up Node. </p><p>On Twitter as <a href="https://twitter.com/samlewisgreen" class="highlight">samlewisgreen</a> and GitHub as <a href="https://github.com/greensam" class="highlight">greensam</a>.</p><p> <a href="/" class="highlight">‚Üê http://samuelgreen.org</a></p></footer><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-324369-3', 'shapeshed.com');
ga('require', 'linkid', 'linkid.js');
ga('send', 'pageview');
</script><script src="/javascripts/application-cd0edf416a4508b2ef871854ce2169f2.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>